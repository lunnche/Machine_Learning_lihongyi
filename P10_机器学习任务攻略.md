## General Guidance  

## Framework of ML  

![image-20220208202740253](https://raw.githubusercontent.com/lunnche/picgo-image/main/image-20220208202740253.png)

![image-20220208203106918](https://raw.githubusercontent.com/lunnche/picgo-image/main/image-20220208203106918.png)

æ‰§è¡ŒåŠ©æ•™çš„sample code å°±å¯ä»¥è¿‡baselineï¼Œå¦‚æœæƒ³è¦åšçš„æ›´å¥½ï¼Œè¦æ€ä¹ˆåŠå‘¢ï¼Ÿ  

![image-20220208203402511](https://raw.githubusercontent.com/lunnche/picgo-image/main/image-20220208203402511.png)

å¦‚æœä½ è§‰å¾—ä½ çš„æ¨¡å‹ç»“æœä¸å¥½ï¼Œå…ˆå»æ£€æŸ¥loss on training dataï¼Œæ˜¯ä¸æ˜¯è®­ç»ƒæ•°æ®ä½ å°±æ²¡å­¦å¥½ï¼Ÿå¦‚æœlosså¾ˆå¤§ï¼Œé‚£ä¹ˆå°±çœ‹çœ‹model bias  

æœ‰å¯èƒ½æ˜¯ä½ çš„function setå¤ªå°äº†ï¼Œèƒ½è·å¾—small lossçš„functionæ ¹æœ¬å°±ä¸åœ¨ä½ çš„æœç´¢èŒƒå›´å†…ï¼Œå°±ç®—ä½ åœ¨ä½ é‚£æŠ å—¦çš„function set é‡Œæ‰¾å‡ºäº†æœ€ä¼˜ï¼Œä¹Ÿæ— æµäºäº‹ã€‚  æ€ä¹ˆåŠï¼Ÿ  

é‡æ–°è®¾è®¡ä½ çš„model ï¼Œç»™å®ƒæ›´å¤§çš„flexibleã€‚  

æ€ä¹ˆå¢åŠ modelçš„å¼¹æ€§ï¼Ÿ
1. more features
2. deep learning (more neurons,layers)  

![image-20220208204652319](https://raw.githubusercontent.com/lunnche/picgo-image/main/image-20220208204652319.png)

ä½†æ˜¯training data loss å¹¶ä¸ä¸€å®šæ˜¯model biasé€ æˆçš„ï¼Œå¯èƒ½æ˜¯ä¼˜åŒ–ä¸åˆ°ä½é€ æˆçš„  

çœ‹åˆ° P10 08ï¼š07

## Optimization Issue  
æœ¬é—¨è¯¾ç¨‹åªä¼šç”¨åˆ°gradient descent è¿™ç§optimization è¿™ç§æ–¹æ³•ã€‚è¿™ç§æ–¹æ³•æœ‰å¾ˆå¤šé—®é¢˜ï¼Œæ¯”å¦‚ä½ å¯èƒ½å¡åœ¨local minimaå¤„ï¼Œæ²¡æœ‰åŠæ³•æ‰¾åˆ°ä¸€ä¸ªçœŸçš„è®©lossä½çš„å‚æ•°ï¼Œ
ï¼ˆä¹‹å‰è¯´å¡åœ¨local minimaå¤„æ˜¯ä¸€ä¸ªå‡é—®é¢˜çš„å‰ææ˜¯ï¼Œæ•°æ®è¶³å¤Ÿå¤šï¼Œè§£ç©ºé—´æ¯”è¾ƒå°ï¼Œä»è€Œå±€éƒ¨æå€¼ç‚¹æ¯”è¾ƒå°‘ï¼Ÿï¼ˆå¼¹å¹•ï¼‰ï¼‰  

å¯¹åº”åˆ°å›¾é‡Œï¼Œæ„æ€å°±æ˜¯è“è‰²çš„function setä¸­ç¡®å®æœ‰lossæ¯”è¾ƒä½çš„ç‚¹ï¼ˆæ©™è‰²ç‚¹ï¼‰ï¼Œä½†gradient descent æ²¡æœ‰åŠæ³•å¸®æˆ‘ä»¬æ‰¾åˆ°è¿™ä¸€ç‚¹ã€‚  

gradient descentç»™åˆ°ä½ $\theta^*$ å°±ç»“æŸäº†ï¼Œä½†å®ƒçš„lossä¸å¤Ÿä½  

![image-20220209191247990](https://raw.githubusercontent.com/lunnche/picgo-image/main/image-20220209191247990.png)

é‚£ä¹ˆé—®é¢˜æ¥äº†ï¼Œå½“æˆ‘ä»¬å‘ç°training data çš„losså¤§æ—¶ï¼Œåˆ°åº•æ˜¯å› ä¸ºModel bias,æˆ‘ä»¬æ¨¡å‹çš„å¼¹æ€§ä¸å¤Ÿï¼Œæˆ‘ä»¬çš„æµ·é‡Œé¢æ²¡æœ‰é’ˆï¼Œ è¿˜æ˜¯optimization issueï¼Œæˆ‘ä»¬æ¨¡å‹çš„å¼¹æ€§å¤Ÿäº†ï¼Œé’ˆåœ¨æµ·é‡Œï¼Œä½†gradient descent ä¸ç»™åŠ›ï¼Œæ²¡åŠæ³•æ‰¾åˆ°æµ·é‡Œçš„é’ˆã€‚  
æˆ–è€…è¯´æˆ‘ä»¬çš„function set å·²ç»è¶³å¤Ÿå¤§äº†ï¼Œè¿˜æ˜¯ä¸å¤Ÿå¤§ã€‚  



![image-20220209191942124](https://raw.githubusercontent.com/lunnche/picgo-image/main/image-20220209191942124.png)

å»ºè®®çš„æ–¹æ³•å°±æ˜¯é€šè¿‡æ¯”è¾ƒä¸åŒçš„æ¨¡å‹ï¼Œæ¥åˆ¤æ–­ä½ çš„modelå¤Ÿä¸å¤Ÿå¤§ã€‚  

**Residual network**çš„paper(2015å¹´çš„): http://arxiv.org/abs/1512.03385  

![image-20220209192544461](https://raw.githubusercontent.com/lunnche/picgo-image/main/image-20220209192544461.png)

ä½ å†æµ‹è¯•é›†ä¸Šå‘ç°56-layer networkæ•ˆæœä¸å¦‚20-layerçš„networkï¼Œä¸è¦ç€æ€¥ä¸‹åˆ¤æ–­è¯´è¿™æ˜¯overfittingï¼Œå»çœ‹çœ‹è®­ç»ƒé›†ï¼Œ56-layeræ•ˆæœä¾ç„¶æ¯”20-layerå·®ï¼Œ56å±‚æ¨¡å‹å¼¹æ€§è‚¯å®šæ¯”20å±‚å¥½ï¼Œæ‰€ä»¥ä¸æ˜¯model bias,æ˜¯optimization issueã€‚  

## Optimization Issue  
* Gaining the insights from comparison
* Start from shallower networks(or other models),which are easier to optimize.  

ä½ æ€ä¹ˆçŸ¥é“ä½ çš„optimizationæœ‰æ²¡æœ‰åšå¥½å‘¢ï¼Ÿ çœ‹åˆ°ä¸€ä¸ªä½ ä»æ¥æ²¡æœ‰åšè¿‡çš„é—®é¢˜ï¼Œä½ å¯ä»¥å…ˆè·‘ä¸€äº›æ¯”è¾ƒå°ï¼Œæ¯”è¾ƒæµ…çš„networkï¼Œæˆ–ç”šè‡³ç”¨ä¸€äº›ä¸æ˜¯deep learning çš„æ–¹æ³•ï¼Œlinear model ï¼Œsupport vector machine, è¿™äº›æ–¹æ³•æ˜¯æ¯”è¾ƒå®¹æ˜“åšoptimizeçš„ï¼Œä¸å¤ªä¼šæœ‰optimizatonå¤±è´¥çš„é—®é¢˜ã€‚  

* if deeper networks do not obtain smaller loss on **training data**,then there is optimization issue.  

![image-20220209193904281](https://raw.githubusercontent.com/lunnche/picgo-image/main/image-20220209193904281.png)
æ¯”å¦‚è¿™ä¸ªä¾‹å­ï¼Œå°±æ˜¯optimization issue.  

optimization åšçš„ä¸å¥½çš„è¯ æ€ä¹ˆåŠå‘¢ï¼Ÿ  
* Solution:More powerful optimization technology (next lecture)  

ç°åœ¨å‡è®¾ç»è¿‡åŠªåŠ›å·²ç»å¯ä»¥ä½¿ä½ çš„training dataçš„losså˜å°äº†ï¼Œæ¥ä¸‹æ¥å°±å¯ä»¥çœ‹testing dataçš„loss  

training dataçš„losså°ï¼Œtesting dataçš„losså¤§ï¼Œæ‰å«åšoverfittingã€‚  

## Overfitting  
* Small loss on training data, large loss on testing data.Why?  

æ¥çœ‹è¿™ä¸ªä¸€æ— æ˜¯å¤„çš„æ–¹æ³•ï¼šæ•°æ®åº“å­¦ä¹ æ³• database learning ï¼ˆç®€ç§°ä¹Ÿæ˜¯DLï¼‰

![image-20220209195148994](https://raw.githubusercontent.com/lunnche/picgo-image/main/image-20220209195148994.png)

è¿‡æ‹Ÿåˆ è¿‡äºæ‹Ÿåˆè®­ç»ƒæ ·æœ¬è€Œå¯¹å…¶ä»–æµ‹è¯•æ ·æœ¬çš„æ³›åŒ–èƒ½åŠ›ä¸å¤Ÿã€‚  (å¼¹å¹•ï¼‰  

ä¸€èˆ¬æ¥è¯´ï¼Œæ¨¡å‹å¼¹æ€§è¿‡å¼ºï¼Œåœ¨æ²¡æœ‰ç»™å‡ºè®­ç»ƒå€¼çš„åœ°æ–¹å°±ä¼šæ¨¡æ‹Ÿè¿‡äº†ã€‚  

overfittingèƒŒåçš„æ•°å­¦åŸç†  é¾™æ ¼ï¼ˆRungeï¼‰ç°è±¡ï¼Ÿï¼ˆå¼¹å¹•ï¼‰  

![image-20220209200303884](https://raw.githubusercontent.com/lunnche/picgo-image/main/image-20220209200303884.png)
æ¢è¨€ä¹‹ï¼Œå½“ä½ åªæœ‰æ¯”è¾ƒå°‘çš„æ•°æ®æ—¶ï¼Œå°±ä¸è¦æŠŠæ¨¡å‹æå¤ªå¤æ‚ã€‚

æ€ä¹ˆè§£å†³overfittingçš„é—®é¢˜å‘¢ï¼Ÿæœ‰ä¸¤ä¸ªæ–¹å‘ï¼š  
1. å¾€å¾€æ˜¯æœ€æœ‰æ•ˆçš„æ–¹å‘ï¼šå¢åŠ è®­ç»ƒèµ„æ–™
p10 21:39
Data augmentation æ•°æ®å¢å¼º
åˆ©ç”¨ä½ å¯¹é—®é¢˜çš„ç†è§£åˆ›é€ å‡ºæ–°çš„èµ„æ–™ï¼Œæ¯”å¦‚ï¼Œåšå½±åƒè¾¨è¯†é‡Œï¼Œå¾ˆå¸¸ç”¨çš„ä¸€æ‹›ï¼ŒæŠŠä¸€ä¸ªå›¾ç‰‡å·¦å³ç¿»è½¬ï¼Œæˆ–å…¶ä¸­ä¸€å—æˆªå‡ºæ¥ï¼Œ  
ä½†è¦æ³¨æ„çš„æ˜¯ï¼Œaugmentè¦æœ‰é“ç†ï¼Œæ¯”å¦‚å½±åƒè¾¨è¯†ä¸­ï¼Œä¸ä¼šæœ‰äººæŠŠç…§ç‰‡å€’è¿‡æ¥ã€‚

![image-20220209222218184](https://raw.githubusercontent.com/lunnche/picgo-image/main/image-20220209222218184.png)

2. ç»™ä½ çš„æ¨¡å‹ä¸€äº›é™åˆ¶
å¢åŠ èµ„æ–™æ˜¯ä¸€ç§æ–¹æ³•ï¼Œå¦ä¸€ç§æ–¹æ³•æ˜¯ä¸è¦è®©ä½ çš„æ¨¡å‹æœ‰é‚£ä¹ˆå¤§çš„å¼¹æ€§ï¼Œç»™å®ƒä¸€äº›é™åˆ¶ï¼Œæ¯”å¦‚ï¼Œé™åˆ¶æˆ‘ä»¬çš„modelä¸€å®šæ˜¯ä¸€æ¡äºŒæ¬¡æ›²çº¿ï¼Œ

![image-20220209222721741](https://raw.githubusercontent.com/lunnche/picgo-image/main/image-20220209222721741.png)

* Less parameters, sharing parameters    æ¯”è¾ƒå°‘çš„ç¥ç»å…ƒä¸ªæ•°  

    fully-connected neural network å…¶å®æ˜¯ä¸€ä¸ªæ¯”è¾ƒæœ‰å¼¹æ€§çš„æ¶æ„ï¼Œè€ŒCNNæ˜¯ä¸€ä¸ªæ¯”è¾ƒæœ‰é™åˆ¶çš„æ¶æ„ï¼Œå®ƒå‰å®³çš„åœ°æ–¹åœ¨äºé’ˆå¯¹å½±åƒçš„ç‰¹æ€§æ¥é™åˆ¶æ¨¡å‹çš„å¼¹æ€§ï¼Œ

![image-20220209223201694](https://raw.githubusercontent.com/lunnche/picgo-image/main/image-20220209223201694.png)
* Less features
* Early stopping
* Regularization
* Dropout  

ä½†æ˜¯å‘¢ï¼Œä¹Ÿä¸èƒ½è¯´ç»™æ¨¡å‹å¤ªå¤§çš„é™åˆ¶ï¼Œ

![image-20220209223629112](https://raw.githubusercontent.com/lunnche/picgo-image/main/image-20220209223629112.png)

![image-20220209223930360](https://raw.githubusercontent.com/lunnche/picgo-image/main/image-20220209223930360.png)

æ€ä¹ˆåœåœ¨ä¸Šå›¾é‚£ä¸ªæ²¡æœ‰overfittingçš„ä½ç½®å‘¢ï¼Ÿ  

å¾ˆç›´è§‰çš„åšæ³•ï¼Œå°±æ˜¯æŠŠä¸åŒå¤æ‚åº¦çš„æ¨¡å‹åˆ†åˆ«ä¼ åˆ°kaggleä¸Šï¼Œçœ‹mseæ˜¯å¤šå°‘ã€‚  

è¿™ç§"é¢å‘public testç¼–ç¨‹/åœ¨æµ‹è¯•é›†ä¸Šè°ƒå‚"çš„æ–¹æ³•ä¸ä¸€å®šé è°±ï¼š  

![image-20220209224600721](https://raw.githubusercontent.com/lunnche/picgo-image/main/image-20220209224600721.png)


ä¸ºå•¥æµ‹è¯•é›†è¦åˆ†public å’Œ private  

å› ä¸ºä½ å¯ä»¥åšä¸€ä¸ªmodelè¾“å‡ºéšæœºç»“æœï¼Œåªè¦ä½ è¯•å¾—è¶³å¤Ÿå¤šæ¬¡ï¼Œå‡ äº¿å…†æ¬¡ï¼Œå®ƒå¾ˆå¯èƒ½åœ¨public testing setä¸Šå–å¾—å¾ˆå¥½ç»“æœï¼Œä½†åŒæ ·çš„æ¨¡å‹åŸºæœ¬ä¸å¯èƒ½åœ¨private setä¸Šä¹Ÿå–å¾—å¥½æˆç»©ã€‚  

![image-20220209225647237](https://raw.githubusercontent.com/lunnche/picgo-image/main/image-20220209225647237.png)

æ‰€ä»¥ä¸è¦ç”¨public testing set å»è°ƒä½ çš„æ¨¡å‹ï¼Œå› ä¸ºä½ å¯èƒ½è´¥åœ¨private Setä¸Šã€‚  

æ‰€ä»¥åˆ°åº•è¦æ€ä¹ˆåšæ¥é€‰æ‹©model æ‰æ˜¯åˆç†çš„å‘¢ï¼Ÿ  

ä¸å»ºè®®ç”¨publicæµ‹è¯•é›†è°ƒç»“æœï¼Œå› ä¸ºåˆä¼šå¯¼è‡´è´¥åœ¨private testing setä¸Šã€‚  
æœ€å¥½çš„åšæ³•å°±æ˜¯æŒ‘Validation set ä¸Šlossæœ€å°çš„å°±å¥½äº†ï¼Œä½ ä¸ç”¨å»ç®¡public testing set çš„ç»“æœï¼Œ

![image-20220209231011757](https://raw.githubusercontent.com/lunnche/picgo-image/main/image-20220209231011757.png)

é‚£ä¹ˆæ€ä¹ˆåˆ’åˆ† training set å’Œ validation set å‘¢  

## N-fold Cross Validation  
kæŠ˜äº¤å‰éªŒè¯

æœ‰ä¸ªå¼¹å¹•è¯´ï¼Œå¦‚æœé€‰å¥½äº†åˆé€‚çš„modelè®­ç»ƒæ–¹æ³•ï¼Œå°±æŠŠvalidation set ä¹Ÿæ”¾è¿›å»è®­ç»ƒï¼Œè¿™æ ·ä¼šæé«˜åˆ†æ•°ã€‚  å®ƒè¯´çš„æ˜¯å¯¹çš„ï¼Œå’Œè€å¸ˆè®²çš„ä¸€æ ·  

![image-20220209231555943](https://raw.githubusercontent.com/lunnche/picgo-image/main/image-20220209231555943.png)

æœ€åé™¤äº†overfittingï¼Œè¿˜æœ‰ä¸€ç§small loss on training data, large loss on testing data çš„æƒ…å†µï¼Œå« mismatch ï¼Œä½ ä¹Ÿå¯ä»¥è¯´å®ƒæ˜¯ä¸€ç§overfitting ,  
ä¾‹å­æ˜¯å•¥ï¼Œé¢„æµ‹æœºå™¨å­¦ä¹ è§†é¢‘ç‚¹é˜…æ•°ï¼ŒæŒ‰ç†å‘¨äº”æ™šä¸ŠæŒ‰å†å²è§„å¾‹å¤§å®¶éƒ½å‡ºå»ç©æ²¡äººå­¦ä¹ ï¼Œç‚¹é˜…é‡ä¼šè¿æ¥ä½è°·ï¼Œä½†æå‰å‘Šè¯‰å¤§å®¶å…³æ³¨é‚£å¤©çš„ç‚¹çº¦æŸï¼Œç»“æœå¾ˆå¤šäººæ•…æ„å»ç‚¹é˜…ï¼Œå¯¼è‡´å®é™…ä¸ä½†ä¸æ˜¯ä½è°·ï¼Œè€Œä¸”æ˜¯å³°å€¼ï¼Œè¿™å°±æ˜¯mismatch  

ä¸€èˆ¬çš„overfittingä½ å¯ä»¥é€šè¿‡æœé›†æ›´å¤šèµ„æ–™æ¥å…‹æœï¼Œä½†mismatchæ˜¯è¯´ä½ çš„è®­ç»ƒèµ„æ–™å’Œæµ‹è¯•èµ„æ–™çš„åˆ†å¸ƒæ˜¯ä¸ä¸€æ ·çš„ï¼Œè®­ç»ƒèµ„æ–™å†å¢åŠ ä¹Ÿäºäº‹æ— è¡¥ï¼Œ

![image-20220209232556890](https://raw.githubusercontent.com/lunnche/picgo-image/main/image-20220209232556890.png)

å®Œç»“æ’’èŠ± ğŸŒº
