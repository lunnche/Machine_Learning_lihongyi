## å±€éƒ¨æœ€å°å€¼ä¸éç‚¹

ä¸ºä»€ä¹ˆoptimizationä¼šfailï¼Ÿ

ä½ ç»å¸¸ä¼šå‘ç°ï¼Œéšç€ä½ çš„å‚æ•°ä¸æ–­updateï¼Œä½ çš„trainingçš„lossä¸ä¼šå†ä¸‹é™ï¼Œä½†æ˜¯ä½ å¯¹è¿™ä¸ªlossè¿˜æ˜¯ä¸æ»¡æ„ï¼Œ  
æœ‰æ—¶å€™ä½ ç”šè‡³å‘ç°ä½ çš„modelä¸€å¼€å§‹å°±trainä¸èµ·æ¥ï¼Œä¸ç®¡ä½ æ€ä¹ˆupdateä½ çš„å‚æ•°ï¼Œä½ çš„losså§‹ç»ˆæ‰ä¸ä¸‹å»ï¼Œ  

è¿‡å»å¸¸æœ‰çš„ä¸€ä¸ªçŒœæƒ³æ˜¯ï¼Œèµ°åˆ°ä¸€ä¸ªåœ°æ–¹ï¼Œè¿™ä¸ªåœ°æ–¹å‚æ•°å¯¹lossçš„å¾®åˆ†ä¸º0ï¼Œæ­¤æ—¶ï¼Œgradient descentæ²¡æœ‰åŠæ³•å†updateå‚æ•°

å¸¸æœ‰äººè¯´ï¼Œåšdeep learning ç”¨gradient descent ï¼Œä½ ä¼šå¡åœ¨local minima  

ä½†ä½ å†™paperçš„æ—¶å€™ï¼Œåƒä¸‡ä¸è¦è¯´ä»€ä¹ˆå¡åœ¨local minimaè¿™ç§äº‹æƒ…ï¼Œåˆ«äººä¼šè§‰å¾—ä½ éå¸¸æ²¡æœ‰æ°´å‡†ï¼Œ  

ä¸ºä»€ä¹ˆï¼Ÿ
å› ä¸ºä¸æ˜¯åªæœ‰local minimaçš„gradientä¸º0ï¼Œè¿˜æœ‰å…¶ä»–æƒ…å†µï¼Œæ¯”å¦‚saddle point  

saddle point å°±æ˜¯ gradient æ˜¯0 ï¼Œä½†ä¸æ˜¯local minima  ,ä¹Ÿä¸æ˜¯local maximaçš„åœ°æ–¹ï¼Œå‰åæ¯”å®ƒé«˜ï¼Œå·¦å³æ¯”å®ƒä½ã€‚  

gradientä¸º0çš„ç‚¹ï¼Œç»Ÿç§°ä¸ºcritical point ,æ‰€ä»¥å‘¢ä½ å¯ä»¥è¯´ä½ çš„gradientæ²¡æœ‰åŠæ³•å†ä¸‹é™ï¼Œä¹Ÿè®¸æ˜¯å› ä¸ºå¡åœ¨äº†critical pointã€‚ä½†ä½ ä¸èƒ½è¯´å¡åœ¨local minimaã€‚


é—®é¢˜ï¼šä½ å¡åœ¨äº†æŸä¸ªcritical point ï¼Œå¦‚ä½•åŒºåˆ†æ˜¯local minima è¿˜æ˜¯ saddle point?  

ä¸ºä»€ä¹ˆæˆ‘æƒ³è¦çŸ¥é“è¿™ä¸€ç‚¹ï¼Ÿ
å› ä¸ºå¦‚æœå¡åœ¨local minimaï¼Œé‚£å°±æ˜¯æ²¡è·¯å¯èµ°ï¼Œsaddle pointæ—è¾¹è¿˜æ˜¯æœ‰è·¯å¯èµ°çš„ï¼Œè¿˜æ˜¯å¯ä»¥è®©ä½ çš„lossæ›´ä½çš„ï¼Œ

![image-20220214092750643](https://raw.githubusercontent.com/lunnche/picgo-image/main/image-20220214092750643.png)

æ€ä¹ˆåŒºåˆ†ï¼Œç”¨åˆ°ä¸€ç‚¹æ•°å­¦  

## Tayler series Approximation

è™½ç„¶æˆ‘ä»¬æ²¡åŠæ³•å®Œæ•´çŸ¥é“loss å‡½æ•°é•¿ä»€ä¹ˆæ ·ï¼Œä½†å¦‚æœç»™å®šä¸€ç»„å‚æ•°,åœ¨å®ƒé™„è¿‘çš„loss func    tionæ˜¯æœ‰åŠæ³•è¢«å†™å‡ºæ¥çš„ã€‚

$L(\theta)$ around $\theta = \theta'$ can be approximated below 

$$
\LARGE
(\theta) \approx L({\color{blue}\theta'}) + (\theta - {\theta}')^T {\color{green}g}+\frac{1}{2}(\theta - {\color{blue}\theta'})^T {\color{red}H} (\theta - {\color{blue}\theta'})
$$

<font size="5">Gradient <font color="green">g</font> is a vector</font>
$$
\LARGE
{\color{green}g}=\nabla L({\color{blue}\theta'})\ \ \ \ 
{\color{green}g_i}=\frac{\partial{L({\color{blue}\theta'})}}{\partial{\theta_i}}
$$

$L(\theta)$è¿™ä¸ªloss functionï¼Œè¿™ä¸ªerror surfaceåœ¨$\theta'$é™„è¿‘ï¼Œå¯ä»¥ç”¨åè¾¹é‚£ä¸¤é¡¹ç›¸åŠ æ¥è¿‘ä¼¼ï¼Œç¬¬ä¸€é¡¹æ˜¯ç»¿è™šçº¿ï¼Œç¬¬äºŒé¡¹æ˜¯çº¢è™šçº¿

![image-20220214102634418](https://raw.githubusercontent.com/lunnche/picgo-image/main/image-20220214102634418.png)

![image-20220214102657034](https://raw.githubusercontent.com/lunnche/picgo-image/main/image-20220214102657034.png)



![image-20220214102714521](https://raw.githubusercontent.com/lunnche/picgo-image/main/image-20220214102714521.png)

gæ˜¯ä¸€æ¬¡å¾®åˆ†ï¼ŒHé‡Œé¢æœ‰äºŒæ¬¡å¾®åˆ†çš„é¡¹







gæ˜¯ä¸€ä¸ªå‘é‡ï¼Œ$g_i$å°±æ˜¯gçš„ç¬¬iä¸ªcomponent

åœ¨ä¸Šé¢çº¢è‰²Hï¼šæµ·å¡çŸ©é˜µ  

Hessian <font size="8" color="red">H</font> is a <u>matrix</u>
$$
\LARGE
{\color{red}H}_{ij}=\frac{\partial^2}{\partial{\theta_i}\partial{\theta_j}} L({\color{blue}\theta'})
$$

Hé‡Œé¢æ”¾çš„æ˜¯Lçš„äºŒæ¬¡å¾®åˆ†ï¼Œç¬¬iä¸ªrowï¼Œç¬¬jä¸ªcolumnçš„å€¼ï¼Œå°±æ˜¯$L(\theta')$å…ˆå¯¹$\theta_i$åšå¾®åˆ†ï¼Œå†å¯¹$\theta_j$åšå¾®åˆ†ï¼Œï¼ˆæ¬¡åºä¸å½±å“äºŒé˜¶å¯¼æ•°?ï¼‰åšä¸¤æ¬¡å¾®åˆ†ä¹‹åçš„ç»“æœå°±æ˜¯$H_{ij}$


å¦‚æœæˆ‘ä»¬ä»Šå¤©èµ°åˆ°ä¸€ä¸ªcritical pointï¼Œé‚£æ„å‘³ç€gradientä¸º0ï¼Œå³ç»¿è‰²é¡¹ä¸º0ï¼Œåªå‰©ä¸‹çº¢è‰²é¡¹ï¼Œæ ¹æ®çº¢è‰²é¡¹æ¥åˆ¤æ–­$\theta'$é™„è¿‘çš„error surfaceé•¿ä»€ä¹ˆæ ·å­ï¼Œè¿›è€Œå¯ä»¥åˆ¤æ–­è¯¥ç‚¹æ˜¯local min,local max,or saddle pointã€‚

![image-20220214103427261](https://raw.githubusercontent.com/lunnche/picgo-image/main/image-20220214103427261.png)

æ¥çœ‹çœ‹æ€ä¹ˆæ ¹æ®çº¢è‰²é¡¹æ¥åˆ¤æ–­$\theta'$é™„è¿‘çš„çŠ¶å†µï¼Œ

![image-20220214211032564](https://raw.githubusercontent.com/lunnche/picgo-image/main/image-20220214211032564.png)

![image-20220214211412007](https://raw.githubusercontent.com/lunnche/picgo-image/main/image-20220214211412007.png)

![image-20220214211844470](https://raw.githubusercontent.com/lunnche/picgo-image/main/image-20220214211844470.png)


Hä¸ä½†èƒ½å‘Šè¯‰æˆ‘ä»¬æ˜¯å¦saddle pointï¼Œè¿˜may tell us parameter update direction.  


![image-20220214212019975](https://raw.githubusercontent.com/lunnche/picgo-image/main/image-20220214212019975.png)

![image-20220214213441900](https://raw.githubusercontent.com/lunnche/picgo-image/main/image-20220214213441900.png)

å›åˆ°åˆšæ‰é‚£ä¸ªæ —å­ğŸŒ°

![image-20220214215928644](https://raw.githubusercontent.com/lunnche/picgo-image/main/image-20220214215928644.png)

## Saddle point v.s. local minima  
åˆ°P11 25ï¼š35

saddle point å’Œ local minima è°æ›´å¸¸è§ï¼Ÿ  

![image-20220215093038482](https://raw.githubusercontent.com/lunnche/picgo-image/main/image-20220215093038482.png)

![image-20220215093232064](https://raw.githubusercontent.com/lunnche/picgo-image/main/image-20220215093232064.png)

![image-20220215093457956](https://raw.githubusercontent.com/lunnche/picgo-image/main/image-20220215093457956.png)

åœ¨ä¸‰ç»´ç©ºé—´ä¸­æ— è·¯å¯èµ°çš„æƒ…å†µï¼Œåœ¨é«˜ç»´ç©ºé—´æ˜¯æœ‰è·¯å¯èµ°çš„ï¼Œerror surfaceä¼šä¸ä¼šä¹Ÿä¸€æ ·ï¼Ÿ

æ¯”å¦‚åœ¨äºŒç»´ç©ºé—´ä¸­æ˜¯ä¸ªlocal minimaï¼Œä¼šä¸ä¼šåœ¨ä¸‰ç»´ç©ºé—´ä¸­åªæ˜¯ä¸ªsaddle pointï¼Œ
ä¼šä¸ä¼šåœ¨äºŒç»´çš„ç©ºé—´ä¸­æˆ‘ä»¬æ— è·¯å¯èµ°ï¼Œåœ¨æ›´é«˜ç»´çš„ç©ºé—´ä¸­å…¶å®æœ‰è·¯å¯ä»¥èµ°ï¼Œç»´åº¦è¶Šé«˜å¯ä»¥èµ°çš„è·¯å°±è¶Šå¤šï¼Ÿ
ä»Šå¤©æˆ‘ä»¬å†è®­ç»ƒä¸€ä¸ªnetworkçš„æ—¶å€™ï¼Œæˆ‘ä»¬çš„å‚æ•°åŠ¨è¾„ç™¾ä¸‡ï¼Œåƒä¸‡ï¼Œä¸Šäº¿ï¼Œæ‰€ä»¥æˆ‘ä»¬çš„error surfaceå…¶å®æ˜¯åœ¨ä¸€ä¸ªéå¸¸é«˜çš„ç»´åº¦ä¸­ï¼Œæˆ‘ä»¬çš„å‚æ•°æœ‰å¤šå°‘ï¼Œå°±ä»£è¡¨æˆ‘ä»¬error surfaceçš„ç»´åº¦æœ‰å¤šå°‘ï¼Œæœ‰ä¸€åƒä¸‡ä¸ªå‚æ•°ï¼Œnetworkçš„ç»´åº¦å°±æ˜¯1000ä¸‡ï¼Œç»´åº¦è¿™ä¹ˆé«˜ï¼Œä¼šä¸ä¼šå…¶å®æœ‰å¾ˆå¤šè·¯å¯ä»¥èµ°å‘¢ï¼Ÿå¦‚æœè·¯å¾ˆå¤šï¼Œä¼šä¸ä¼šå…¶å®local minimaæœ¬æ¥å°±å¾ˆå°‘å‘¢ï¼Ÿ

![image-20220215101402567](https://raw.githubusercontent.com/lunnche/picgo-image/main/image-20220215101402567.png)

ç»éªŒä¸Šæ¥è¯´ï¼Œå¦‚æœä½ å®åšneural networkï¼Œä¼šå‘ç°æ”¯æŒä¸Šè¿°è®ºç‚¹ã€‚  

ä¸‹å›¾å¯è§ï¼Œå®åšä¸­ï¼Œlocal minimaå¾ˆå°‘ï¼Œä½ å¾€å¾€å¡åœ¨äº†saddle point  

![image-20220215102013652](https://raw.githubusercontent.com/lunnche/picgo-image/main/image-20220215102013652.png)

ä½ çœ‹åˆ°å›¾é‡Œ ä¸‹è¾¹ minimum ratio 0.5å¤„ä¸€å †ç‚¹   è¯´æ˜å•¥   è¯´æ˜å®åšä¸­ï¼Œæç«¯æƒ…å†µä¸‹ï¼Œä¹Ÿè¿˜æœ‰ä¸€åŠçš„caseç‰¹å¾å€¼æ˜¯è´Ÿçš„ï¼Œæœ‰ä¸€åŠçš„è·¯å…¶å®éƒ½è¿˜å¯ä»¥è®©lossä¸‹é™ï¼Œç»éªŒä¸Šæ¥è¯´ï¼Œlocal minimaçœŸçš„å¾ˆå°‘ï¼Œå¤šæ•°æ—¶å€™ï¼Œä½ trainåˆ°ä¸€ä¸ªåœ°æ–¹ï¼Œä½ çš„gradientçœŸçš„å¾ˆå°ï¼Œä½ çš„å‚æ•°ä¸å†updateäº†ï¼Œå¾€å¾€æ˜¯å¡åœ¨äº†saddle pointã€‚

ä¸‹é¢æ¥çœ‹å¡åœ¨saddle pointé™„è¿‘éå¸¸å¹³å¦çš„åœ°æ–¹ï¼Œæœ‰ä»€ä¹ˆè§£å†³æ–¹æ³•ï¼Ÿ

![image-20220215104019675](https://raw.githubusercontent.com/lunnche/picgo-image/main/image-20220215104019675.png)


